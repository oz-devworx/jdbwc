/* ********************************************************************
 * Copyright (C) 2010 Oz-DevWorX (Tim Gall)
 * ********************************************************************
 * This file is part of JDBWC.
 *
 * JDBWC is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * JDBWC is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with JDBWC.  If not, see <http://www.gnu.org/licenses/>.
 * ********************************************************************
 */
package jdbwctest;

import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.ResultSetMetaData;
import java.sql.SQLException;
import java.sql.Statement;

import com.jdbwc.core.jdbc2.optional.WCDataSource;

/**
 * @author Tim Gall
 * @version 27/05/2010
 */
public class OpenTesting {

	/**
	 *
	 */
	public OpenTesting() {

		// Create a VendorDataSource object and set some properties
		WCDataSource vds = new WCDataSource();

		vds.setDescription("DataSource for jdbwc testing.");

		/* Required */
		vds.setHostUrl("http://localhost:8085/");
		vds.setHostUser("ozdevworx");
		vds.setHostPass("wkxUZ75CvsoLjqE");

		vds.setDatabaseType("mysql");
		vds.setDatabaseName("jdbwctest");
		vds.setDatabaseUser("ozdevworx");
		vds.setDatabasePass("BzbSeEp26KPxF5WH7vq9");




		System.err.println("getJdbcUrl = " + vds.getJdbcUrl());
		System.err.println("getFullUrl = " + vds.getFullUrl());
		System.err.println("getDescription = " + vds.getDescription());

		System.err.println("getDatabaseType = " + vds.getDatabaseType());
		System.err.println("getDatabaseName = " + vds.getDatabaseName());
		System.err.println("getDatabaseUser = " + vds.getDatabaseUser());

		System.err.println("getHostUrl = " + vds.getHostUrl());
		System.err.println("getHostUser = " + vds.getHostUser());


		Connection connection = null;
		try {
			connection = vds.getConnection();
			System.err.println("connection.isValid = " + connection.isValid(10));

			String query = "SELECT * FROM test02;";

			Statement statement = connection.createStatement();
			ResultSet res = statement.executeQuery(query);
			ResultSetMetaData resMeta = res.getMetaData();

			System.err.println();
			System.err.println("QUERY: " + query);
			System.err.println("-------------------------");

			while(res.next()){
				for(int i = 1; i <= resMeta.getColumnCount(); i++){
					System.err.println(resMeta.getColumnLabel(i) + " = " + res.getString(i));
				}
			}

			res.close();
			statement.close();
			connection.close();

			connection = null;

		} catch (SQLException e) {
			e.printStackTrace();
		} finally{
			if(connection!=null){
				try {
					connection.close();
				} catch (SQLException e) {
					// ignored
				}
			}
		}


		vds = null;

	}

	/**
	 * @param args
	 */
	public static void main(String[] args) {
		new OpenTesting();

		System.err.println("---FINISHED---");
		System.exit(0);
	}

}
